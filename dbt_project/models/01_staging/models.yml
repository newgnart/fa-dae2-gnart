version: 2

models:
  - name: stg_transfer
    description: "Staging model for transfer events with type casting"
    columns:
      - name: id
        description: "Unique transfer ID (transaction_hash_logindex)"
        tests:
          - not_null
          - unique
      - name: block_number
        description: "Block number (cast to bigint)"
        tests:
          - not_null
      - name: block_timestamp
        description: "Block timestamp in UTC"
        tests:
          - not_null
      - name: contract_address
        description: "Token contract address"
        tests:
          - not_null
      - name: from_address
        description: "Sender address"
      - name: to_address
        description: "Recipient address"
      - name: amount_raw
        description: "Transfer amount in smallest unit (before decimal adjustment)"
      - name: _dlt_load_id
        description: "DLT load identifier"
      - name: _dlt_id
        description: "DLT unique row identifier"

  - name: stg_stablecoin
    description: "Staging model for stablecoin metadata with type casting"
    columns:
      - name: contract_address
        description: "Token contract address"
        tests:
          - not_null
      - name: chain
        description: "Blockchain identifier"
        tests:
          - not_null
      - name: symbol
        description: "Token symbol (e.g., USDT, USDC)"
      - name: name
        description: "Full token name"
      - name: currency
        description: "ISO currency code (usd, eur, etc.)"
      - name: backing_type
        description: "Collateral type: fiat-backed, crypto-backed, algorithmic"
      - name: decimals
        description: "Token decimal places"
        tests:
          - not_null
      - name: _dlt_load_id
        description: "DLT load identifier"
      - name: _dlt_id
        description: "DLT unique row identifier"
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - contract_address
            - chain
